<!DOCTYPE html>
<html>
	<style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
            background: url('/static/assets/img/me.mp4') no-repeat center center fixed;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;
        }

        .content {
            text-align: center;
            background-color: #5fb4cb;
            width: 100%;
            height: 50%;
            z-index: 1;
            border-radius: 2%;
			align-items: center;
			justify-content: center;
        }

        h1 {
            font-size: 3em;
            margin-bottom: 20px;
            color: #03332e;
        }

        form {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        label {
            font-size: 1.7em;
            margin-bottom: 10px;
        }

        input {
            width: 50%;
            padding: 10px;
            margin-bottom: 20px;
            font-size: 1.4em;
            border: 1px solid #9b9999;
            border-radius: 5px;
            box-sizing: border-box;
        }
        input:hover{
            color: #6bd9ce;
        }

        button {
            background-color: #03332e;
            color: #fff;
            border: none;
            padding: 10px 20px;
            font-size: 1.3em;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #00796b;
        }

        #result-container {
            margin-top: 20px;
            padding: 20px;
            display: none;
            background-color: #c1baba;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
        }

       #loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 5px solid transparent;
            border-top-color: #009688;
            border-radius: 50%;
            animation: spin 1s linear infinite, colorChange 3s ease-in-out infinite alternate;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes colorChange {
            0% { border-top-color: #009688; }
            100% { border-top-color: #ff5722; }
        }

        .legitimate {
            color: #03332e;
        }

        .phishing {
            color: #ff2222;
        }
        video {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            z-index: -1; 
        }
    </style>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
	<title>URLClassifier!</title>
    <link rel="stylesheet" href="https://embed.pickaxeproject.com/axe/scripts/inline-button/styles.css">
	<link rel="stylesheet" href="../static/assets/bootstrap/css/index.css">
	<link rel="icon" type="image/png" sizes="1000x999" href="../static/assets/img/CLASSIFIER.png">
	<link rel="stylesheet" href="../static/assets/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Courier+Prime">
	<link rel="stylesheet" href="../static/assets/fonts/font-awesome.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
</head>

<body id="page-top">
	<div id="wrapper">
		<nav class="navbar navbar-dark align-items-start sidebar sidebar-dark accordion bg-gradient-primary p-0" style="color: var(--bs-gray-dark);background: linear-gradient(135deg, rgb(40,106,149) 0%, rgb(255,255,255) 100%), rgb(40,106,149);max-width: 114px;">
			<div class="container d-flex flex-column p-0">
				<hr class="sidebar-divider my-0">
				<ul class="navbar-nav text-light" id="accordionSidebar">
					<li class="nav-item"><a class="nav-link active" href="/" style="max-width: 114px;" target="_blank" rel="noopener noreferrer"><img class="img-fluid" data-bss-hover-animate="bounce" src="../static/assets/img/logo_rounded.png" style="margin-top: 0px;margin-left: 0px;"></a></li>
					<li class="nav-item"><a class="nav-link" href="../PASSWORD/docs/index.html" style="max-width: 114px;" target="_blank" rel="noopener noreferrer"><img class="img-fluid" data-bss-hover-animate="bounce" src="../static/assets/img/thehive.png" style="margin-right: 0px;margin-left: 0px;"></a></li>
					<li class="nav-item"><a class="nav-link" href="../how/how.html" style="max-width: 114px;" target="_blank" rel="noopener noreferrer"><img class="img-fluid" data-bss-hover-animate="bounce" src="../static/assets/img/cortex.png" style="transform: translate(0px);"></a></li>
					<li class="nav-item"><a class="nav-link" href="../h.html" style="max-width: 114px;" target="_blank" rel="noopener noreferrer"><img class="img-fluid" data-bss-hover-animate="bounce" src="../static/assets/img/misp.png" style="transform: translate(0px);"></a></li>
                    <div id="pickaxe-inline-action-btn"data-formid="Teacher_Bot_MSQF0" data-frame-source="https://embed.pickaxeproject.com/axe?id=Teacher_Bot_MSQF0&mode=embed_gold&host=beta&theme=light&opacity=100&font_header=Real+Head+Pro&size_header=30&font_body=Real+Head+Pro&size_body=16&font_labels=Real+Head+Pro&size_labels=14&font_button=Real+Head+Pro&size_button=16&c_fb=FFFFFF&c_ff=FFFFFF&c_fbd=888888&c_bb=228DD7&c_bt=FFFFFF&c_t=000000&s_ffo=100&s_bbo=100&s_f=minimalist&s_b=filled&s_t=2&s_r=2" data-title="Teacher Bot" data-btn-color="228DD7" data-btn-style="filled" data-border-radius="2" data-border-width="2" data-font-color="FFFFFF"></div>
				</ul>
				<div class="text-center d-none d-md-inline"></div>
			</div>
		</nav>
		<div class="d-flex flex-column" id="content-wrapper">
			<div id="content">
				<div class="container-fluid col-xxl-7 col-xl-7 col-lg-8 col-md-9"><img class="img-fluid" src="../static/assets/img/ThePhish_logo.png" style="margin-bottom: 10px;margin-top: 10px;"></div>
				<div class="container-fluid">
					<div class="card shadow">
						<div class="card-header py-3" id="cardHeader" style="background: rgb(248, 249, 252);"><button class="btn btn-primary border rounded disabled col-12" id="listMailsBtn" type="button" style="background: rgb(40,106,149);font-size: 20px;" onclick="list_emails()">List emails</button><div id="progressBar" class="progress d-none" style="height: 44px;font-size:20px">
	<div class="progress-bar progress-bar-striped progress-bar-animated bg-info" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;"></div>
</div></div>
						<div class="card-body" id="cardBodyTableRes">
							<div class="card textwhite bg-secondary text-white shadow d-none" id="logText" style="border-width: 3px;border-color: rgb(68,68,69);height: 250px;margin-bottom: 0px;">
								<div class="card-body overflow-auto" style="background: #31354a;">
									<p class="m-0" style="font-family: 'Share Tech Mono', monospace;"></p>
								</div>
							</div><div id=descDiv>
<h1>Welcome to URL Classifier!</h1> 
<video autoplay muted loop>
	<!-- Provide multiple video formats for better browser compatibility -->
	<source src="/static/assets/img/me.mp4" type="video/mp4">

	Your browser does not support the video tag.
</video>
<div class="content">
   

    <form class="content">
        <label for="url">Enter URL:</label>
        <input type="text" id="url" required>
        <button type="button" onclick="classifyUrl()">Classify</button>
    </form>

	<div id="result-container" style="display: none;">
        <p id="user-url"></p>
        <p id="classification-message"></p>
    </div>
</div>
</div>
</div>
							<div id="divResult" class="d-none" style="border-radius: 0px;margin-top: 17px;">
								<p class="text-center overflow-auto" style="background: rgb(255,212,37);height: 44px;line-height: 44px;color: rgb(255,255,255);margin-bottom: 0px;font-size: 20px;border-radius: 0px;border-top-left-radius: 5px;border-top-right-radius: 5px;"></p>
								<p class="text-center overflow-auto" style="background: rgb(227, 230, 240);color: rgb(133, 135, 150);font-size: 20px;height: 130px;border-radius: 0px;border-bottom-right-radius: 5px;border-bottom-left-radius: 5px;"></p>
							</div><a class="card-link btn btn-primary border rounded d-none" id="goBackLink" href="/" style="background: rgb(40,106,149);font-size: 20px;"><i class="fa fa-arrow-left"></i>&nbsp; Go back to analyze a new e-mail</a>
							<div class="table-responsive table mt-2 d-none" data-aos="fade" id="divDataTable" role="grid" aria-describedby="dataTable_info" style="height: auto;border-top-left-radius: 5px;border-top-right-radius: 5px;">
								<table class="table table-striped table-hover my-0" id="dataTable">
									<thead style="background: rgb(40,106,149);color: rgb(255,255,255);font-size: 20px;">
										<tr style="background: var(--bs-table-bg);">
											<th>UID</th>
											<th>Date</th>
											<th>From</th>
											<th>Subject</th>
											<th>Message</th>
											<th>Subject of the email to analyze</th>
											<th></th>
										</tr>
									</thead>
									<tbody></tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
			<footer class="bg-white sticky-footer">
				<div class="container my-auto">
					<div class="text-center my-auto copyright"><span></span></div>
				</div>
			</footer>
		</div>
	</div>
    <script src="https://embed.pickaxeproject.com/axe/scripts/inline-button/bundle.js"></script>
    <script>
        const typo = new Typo('en_US');
        function checkSpelling(url) {
        const words = url.split(/\b/).filter(word => /\w/.test(word));
    
        // Check each word against the dictionary
        for (const word of words) {
            if (!typo.check(word)) {
                // If a misspelled word is found, check suggestions for possible corrections
                const suggestions = typo.suggest(word);
    
                // If there are suggestions, consider it a potential misspelling
                if (suggestions.length > 0) {
                    return false;
                }
            }
        }
    
        // All words are either correctly spelled or have suggestions for correction
        return true;
    }
    
    
        function checkLegitimateFeatures(url) {
            // Simulated legitimate features check logic
            const { hostname, pathname } = new URL(url);
            const brandNames = ['example'];
            const officialSubdomains = ['support', 'help'];
            const commonTlds = ['.com', '.org', '.net'];
    
            const isHttps = url.startsWith('https://');
            const hasBrandName = brandNames.some(brand => hostname.includes(brand));
            const hasOfficialSubdomain = officialSubdomains.some(subdomain => hostname.includes(subdomain));
            const reasonableUrlLength = url.length < 100;
            const noUnusualCharacters = /^[a-zA-Z0-9-._~:/?#[\]@!$&'()*+,;=]+$/.test(url);
            const hasCommonTld = commonTlds.some(tld => hostname.endsWith(tld));
    
            return {
                HTTPS_Protocol: isHttps,
                Brand_Name_in_Domain: hasBrandName,
                Official_Subdomains: hasOfficialSubdomain,
                Reasonable_URL_Length: reasonableUrlLength,
                No_Unusual_Characters: noUnusualCharacters,
                Common_TLDs: hasCommonTld,
            };
        }
    
        function isVeryCloseMisspelled(legitimateUrl, userUrl) {
            const legitWords = legitimateUrl.split(/\b/).filter(word => /\w/.test(word));
            const userWords = userUrl.split(/\b/).filter(word => /\w/.test(word));
    
            return legitWords.some(legitWord =>
                userWords.some(userWord =>
                    typo.suggest(legitWord).includes(userWord) || typo.suggest(userWord).includes(legitWord)
                )
            );
        }
    
        function classifyUrl() {
            const userUrl = document.getElementById('url').value;
            
    
            // Check if the input is a valid URL
            if (!is_valid_url(userUrl)) {
                alert("Please enter a valid URL.");
                return;
            }
            
    
            // Attempt to construct a URL object
            try {
                const { protocol, hostname } = new URL(userUrl);
    
                // Check for unusual characters in the protocol
                if (protocol.toLowerCase() !== 'https:') {
                    displayResult(userUrl, 'Phishing');
                    return;
                }
    
                // Check for symbols after the second dot in the hostname
                const secondDotIndex = hostname.indexOf('.', hostname.indexOf('.') + 1);
                if (secondDotIndex !== -1 && /[^\w.]/.test(hostname.substring(secondDotIndex + 1))) {
                    displayResult(userUrl, 'Phishing');
                    return;
                }
    
                // Check for symbols within the domain name (excluding "www" and "google")
                const domainWithoutWWW = hostname.replace(/^www\./, ''); // Remove leading "www."
                const domainWithoutGoogle = domainWithoutWWW.replace(/google/, ''); // Remove "google"
                if (/[^\w.]/.test(domainWithoutGoogle)) {
                    displayResult(userUrl, 'Phishing');
                    return;
                }
    
                // Check for symbols after "www" or "google" in the hostname
                const wwwIndex = hostname.indexOf('www.');
                const googleIndex = hostname.indexOf('google');
                if ((wwwIndex !== -1 && /[^\w.]/.test(hostname.substring(wwwIndex + 4))) ||
                    (googleIndex !== -1 && /[^\w.]/.test(hostname.substring(googleIndex + 6)))) {
                    displayResult(userUrl, 'Phishing');
                    return;
                }
    
                // Check for symbols in the second-level domain
                if (/@/.test(hostname.split('.')[0])) {
                    displayResult(userUrl, 'Phishing');
                    return;
                }
    
                // Check for symbols in the top-level domain
                const tld = hostname.split('.').pop();
                const commonTlds = ['.com', '.co', '.org', '.us', '.net', '.blog', '.io', '.biz'];
                if (!commonTlds.includes('.' + tld)) {
                    displayResult(userUrl, 'Phishing');
                    return;
                }
    
                // Continue with the existing classification logic...
                // Simulated check if the domain is in the list of legitimate domains
                const legitimateDomains = new Set(['example.com']);
                if (legitimateDomains.has(hostname)) {
                    displayResult(userUrl, 'Legitimate');
                    return;
                }
    
                // Simulated check against legitimate features
                const legitimateFeatures = checkLegitimateFeatures(userUrl);
                if (legitimateFeatures.HTTPS_Protocol && legitimateFeatures.Reasonable_URL_Length) {
                    displayResult(userUrl, 'Legitimate');
                    return;
                }
    
                // Simulated classify based on phishing features
                const isPhishing = !checkSpelling(userUrl) || !legitimateFeatures.Common_TLDs;
                if (isPhishing) {
                    displayResult(userUrl, 'Phishing');
                } else {
                    displayResult(userUrl, 'Unknown');
                }
    
                const legitimateUrl = 'example.com';  // Replace with the actual legitimate URL
                if (isVeryCloseMisspelled(legitimateUrl, userUrl)) {
                    displayResult(userUrl, 'Phishing');
                } else {
                    displayResult(userUrl, 'Legitimate');
                }
            } catch (error) {
                console.error('Error:', error.message);
                alert("An error occurred. Please enter a valid URL.");
            }
        }
    
                function displayResult(userUrl, classification) {
                    const resultContainer = document.getElementById('result-container');
                    const userUrlElement = document.getElementById('user-url');
                    const classificationMessage = document.getElementById('classification-message');
    
                    userUrlElement.innerText = 'Entered URL: ' + userUrl;
    
                    if (classification === 'Legitimate') {
                        classificationMessage.innerText = 'This site is legitimate.';
                        classificationMessage.style.color = '#03332e';
                    } else if (classification === 'Phishing') {
                        classificationMessage.innerText = 'This site is identified as a phishing site.';
                        classificationMessage.style.color = '#ff2222';
                    } else {
                        classificationMessage.innerText = 'Result: ' + classification;
                        classificationMessage.style.color = '#000';
                    }
    
                    resultContainer.style.display = 'block';
                }
    
                function is_valid_url(s) {
                    try {
                        var result = new URL(s);
                        return result.protocol !== "" && result.host !== "";
                    } catch (error) {
                        return false;
                    }
                }
    
    
        function displayResult(userUrl, classification) {
            const resultContainer = document.getElementById('result-container');
            const userUrlElement = document.getElementById('user-url');
            const classificationMessage = document.getElementById('classification-message');
    
            userUrlElement.innerText = 'Entered URL: ' + userUrl;
    
            if (classification === 'Legitimate') {
                classificationMessage.innerText = 'This site is legitimate.';
                classificationMessage.style.color = '#03332e';
            } else if (classification === 'Phishing') {
                classificationMessage.innerText = 'This site is identified as a phishing site.';
                classificationMessage.style.color = '#ff2222';
            } else {
                classificationMessage.innerText = 'Result: ' + classification;
                classificationMessage.style.color = '#000';
            }
    
            resultContainer.style.display = 'block';
        }
    </script>
    
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
	<script src="../static/assets/bootstrap/js/bootstrap.min.js"></script>
	<script src="../static/assets/js/bs-init.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
	<script src="../static/assets/js/theme.js"></script>
	<script src="../static/assets/js/thephish.js"></script>
    
</body>

</html>